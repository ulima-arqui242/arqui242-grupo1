# 3.2. Modelo de Coordinación

## ADR 1: Comunicación entre Microservicios - NATS, REST o gRPC

### Contexto

La plataforma **MedSysPro** se compone de múltiples microservicios especializados en funciones como autenticación, gestión de pacientes, recetas y teleconsultas. Para asegurar una operación fluida, estos microservicios deben comunicarse de manera efectiva. La elección del mecanismo de comunicación afectará directamente aspectos críticos como la latencia, la escalabilidad y la resiliencia del sistema. Es importante evaluar si se necesita una comunicación síncrona o asíncrona, así como la capacidad de manejar grandes volúmenes de tráfico y eventos en tiempo real.

### Alternativas

- **NATS (Mensajería Asíncrona):** NATS es un sistema ligero y eficiente de mensajería distribuida, ideal para la comunicación asíncrona entre microservicios.

  - Facilita una comunicación rápida y escalable, permitiendo que los microservicios procesen eventos sin necesidad de respuestas inmediatas.
  - Es fácil de implementar y operar, lo que lo convierte en una opción atractiva para el equipo que no tiene experiencia previa con herramientas más complejas como Kafka.
  - Su enfoque en la simplicidad y alto rendimiento lo hacen adecuado para los requisitos de MedSysPro, donde se necesita manejar eventos en tiempo real de manera eficiente.

- **REST:** Es un protocolo ampliamente adoptado para la comunicación directa y síncrona mediante HTTP.

  - Su facilidad de implementación y compatibilidad con la mayoría de lenguajes lo hacen ideal para la interoperabilidad.
  - Es útil en casos donde se requiere una respuesta inmediata, como la validación de datos o la gestión de usuarios en tiempo real.
  - Al síncrona lo hace menos adecuado para manejar grandes volúmenes de datos o solicitudes frecuentes, ya que puede generar latencias y afectar el rendimiento general.

- **gRPC:** Es un protocolo de alto rendimiento basado en HTTP/2 y Protobuf, que permite la comunicación rápida y eficiente entre microservicios.
  - Soporta comunicación bidireccional, lo que lo hace ideal para sistemas que requieren baja latencia y alta frecuencia de interacción.
  - Aunque es más eficiente que REST, su implementación puede ser más compleja debido a la necesidad de definir esquemas y su dependencia de HTTP/2
  - Para el equipo actual, que no tiene experiencia previa con gRPC, esta opción podría aumentar la dificultad de desarrollo.

### Criterios de Elección

- Tipo de comunicación (síncrona vs. asíncrona).
- Capacidad para manejar grandes volúmenes de tráfico y escalabilidad.
- Facilidad de implementación y alineación con las habilidades del equipo.
- Resiliencia ante fallos del sistema.
- Desempeño a largo plazo y facilidad de mantenimiento.

### Decisión

Se ha decidido implementar **NATS** para la comunicación entre microservicios en MedSysPro.

### Sustento

**NATS** fue seleccionado debido a su simplicidad y capacidad para manejar eventos de manera asíncrona y escalable. Además, su facilidad de implementación es ideal para el equipo actual, que no tiene experiencia con soluciones más complejas como Kafka ni con Microservicios. NATS ofrece el equilibrio adecuado entre rendimiento y simplicidad, permitiendo una integración fluida con los microservicios sin agregar una carga operativa significativa. REST fue descartado por sus limitaciones en el manejo de grandes volúmenes de datos y su naturaleza síncrona, mientras que gRPC, aunque eficiente, se considera más complicado de implementar para las capacidades actuales del equipo.
